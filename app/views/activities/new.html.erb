<%= render 'programs/sidebar' do %>
    <%= render 'shared/error_messages', errors: (@errors || []) %>
    <h2><%= t :Add_activity %></h2>
    <%= form_for @activity, url: program_activities_path(@program),
                html: {class: 'auto-width'} do |form| %>
      <div class="form-group">
        <%= form.label :type, t(:Activity_type) %>
        <%= form.select(:type, options_for_select(Activity.types_for_select),
                        {}, {class: 'form-control', autofocus: true}) %>
      </div>

      <div class="type-specific-part" id="translation-activity-part">
        <%= render "new_translation_activity", form: form %>
      </div>

      <div class="form-group">
        <%= label_tag :stage_start_date, t(:As_of) %>
        <%= render 'shared/fuzzy_date_field', model: 'activity', field: 'stage_start_date'  %>
      </div>

      <% unless @program.participants.empty? %>
        <div class="form-group">
          <%= label_tag :participants do %>
            <% activity_name = "<span class='activity-name'>#{t(:new_activity)}</span>" %>
            <%= t(:Associate_people, activity: activity_name).html_safe %>
          <% end %>

          <ul class="list-inline">
            <li><a href="#" data-check-all><%= t :All %></a></li>
            <li><a href="#" data-check-none><%= t :None %></a></li>
          </ul>

          <% @program.participants.each do |participant| %>
            <div class="checkbox">
              <label>
                <%= check_box_tag('activity[participant_ids][]', participant.id) %>
                <%= participant.person.full_name %>
              </label>
            </div>
          <% end %>
        </div>
      <% end %>

      <%= form.submit t(:Save), class: 'btn btn-primary btn-lg', data: {'new_activity_submit' => 1} %>
  <% end %>
<% end %>