<nav class="navbar navbar-fixed-top navbar-inverse" id="app_header">
  <div class="container-fluid">
    <div class="navbar-header">
      <% if logged_in? %>
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
      <% end %>
      <%= link_to(image_tag("dulu.png", size: "107x40"), root_url ,id: "logo") %>
    </div>
    <% if logged_in? %>
      <div id="navbar" class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li>
            <div class="dropdown">
              <button class="btn btn-link nav-btn dropdown-toggle" data-toggle="dropdown">
                <%= t(:People) %>
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li><%= link_to t(:People), people_path %></li>
                <li><%= link_to t(:LanguageProgramFacilitators), lpfs_path %></li>
                <li><%= link_to t(:Organizations), organizations_path %></li>
              </ul>
            </div>
          </li>
          <li>
            <div class="dropdown">
              <button class="btn btn-link nav-btn dropdown-toggle" data-toggle="dropdown">
                <%= t(:Languages) %>
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li><%= link_to t(:Languages), languages_path %></li>
                <li><%= link_to t(:Clusters), clusters_path %></li>
                <li><%= link_to t(:Programs), programs_path %></li>
                <% survey = Survey.find_by(open: true) %>
                <% if survey %>
                  <li><%= link_to survey.display_name, survey_path(survey) %></li>
                <% end %>
              </ul>
            </div>
          </li>
          <li><%= link_to t(:Events), events_path %></li>
          <li><%= link_to t(:Reports), reports_path %></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <% notifications = user_notifications %>
          <% unless notifications.empty? %>
            <% unread = !notifications.first.read %>
            <li>
              <div class="btn-group">
                <button type="button" class="btn btn-link dropdown-toggle notification-bell" data-toggle="dropdown">
                  <span class="glyphicon glyphicon-bell <%= 'unread-notifications' if unread %>"></span>
                </button>
                <ul class="dropdown-menu notifications">
                  <% notifications.each do |notification| %>
                    <li class="<%= 'unread' unless notification.read %>">
                      <%= render 'notifications/text', notification: notification %>
                    </li>
                    <% unless notification == notifications.last %>
                      <li role="separator" class="divider"></li>
                    <% end %>
                  <% end %>
                </ul>
              </div>
            </li>
          <% end %>
          <li>
            <div class="btn-group">
              <button type="button" class="btn btn-link nav-btn dropdown-toggle" data-toggle="dropdown">
                <%= @current_user.first_name %>
                <span class="caret"></span>
              </button>
              <ul class="dropdown-menu">
                <li><%= link_to t(:My_info), edit_person_path(@current_user, referred_by: request.path) %></li>
                <li><%= link_to t(:Log_out), logout_url, method: :delete %></li>
              </ul>
            </div>
          </li>
        </ul>
        <%= form_tag(search_path, method: :get, class: 'navbar-form navbar-right') do %>
          <%= text_field_tag :q, '', placeholder: t(:Search_bar), class: 'form-control', size: 16; %>
        <% end %>
      </div>
    <% end %>
  </div>
</nav>